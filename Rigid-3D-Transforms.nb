(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     47500,       1427]
NotebookOptionsPosition[     43563,       1350]
NotebookOutlinePosition[     43995,       1367]
CellTagsIndexPosition[     43952,       1364]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Get", "[", 
  RowBox[{
   RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
   "\"\<Packages\\\\RigidAlgebra3D.wl\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.9447034126676207`*^9, 3.944703430120678*^9}, {
  3.9447575279080076`*^9, 3.944757530037926*^9}, {3.9448533730090427`*^9, 
  3.9448533748380156`*^9}, {3.94485363485894*^9, 3.944853653507166*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"a7d79b4c-8ac3-49dc-931a-f2ce114ed620"],

Cell[BoxData[
 RowBox[{"p", ":=", 
  RowBox[{
   RowBox[{"px", " ", 
    RowBox[{"e", "[", "1", "]"}]}], "+", 
   RowBox[{"py", " ", 
    RowBox[{"e", "[", "2", "]"}]}], "+", 
   RowBox[{"pz", " ", 
    RowBox[{"e", "[", "3", "]"}]}], "+", 
   RowBox[{"pw", " ", 
    RowBox[{"e", "[", "4", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7868448224086885`*^9, 3.786844827131869*^9}, {
  3.84531378015145*^9, 3.8453137808387976`*^9}, {3.866061018538558*^9, 
  3.8660610218041854`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"ce094da8-af9b-46d9-bb0e-4143fb79b96b"],

Cell[BoxData[
 RowBox[{"l", ":=", 
  RowBox[{
   RowBox[{"lvx", " ", 
    RowBox[{"e", "[", 
     RowBox[{"4", ",", "1"}], "]"}]}], "+", 
   RowBox[{"lvy", " ", 
    RowBox[{"e", "[", 
     RowBox[{"4", ",", "2"}], "]"}]}], "+", 
   RowBox[{"lvz", " ", 
    RowBox[{"e", "[", 
     RowBox[{"4", ",", "3"}], "]"}]}], "+", 
   RowBox[{"lmx", " ", 
    RowBox[{"e", "[", 
     RowBox[{"2", ",", "3"}], "]"}]}], "+", 
   RowBox[{"lmy", " ", 
    RowBox[{"e", "[", 
     RowBox[{"3", ",", "1"}], "]"}]}], "+", 
   RowBox[{"lmz", " ", 
    RowBox[{"e", "[", 
     RowBox[{"1", ",", "2"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7868449808285737`*^9, 3.7868449977692347`*^9}, {
  3.8268315956337547`*^9, 3.826831603336306*^9}, {3.8895554565157166`*^9, 
  3.889555463959473*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"a278789b-934c-478c-af32-5bf0b9fd5b65"],

Cell[BoxData[
 RowBox[{"g", ":=", 
  RowBox[{
   RowBox[{"gx", " ", 
    RowBox[{"e", "[", 
     RowBox[{"4", ",", "2", ",", "3"}], "]"}]}], "+", 
   RowBox[{"gy", " ", 
    RowBox[{"e", "[", 
     RowBox[{"4", ",", "3", ",", "1"}], "]"}]}], "+", 
   RowBox[{"gz", " ", 
    RowBox[{"e", "[", 
     RowBox[{"4", ",", "1", ",", "2"}], "]"}]}], "+", 
   RowBox[{"gw", " ", 
    RowBox[{"e", "[", 
     RowBox[{"3", ",", "2", ",", "1"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7868449515774813`*^9, 3.786844953126926*^9}, 
   3.7876234532810187`*^9, {3.868379981957451*^9, 3.8683799893150396`*^9}, {
   3.8895554659324484`*^9, 3.8895554706604185`*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"d20f23ba-1d22-423a-b83c-b2a22e916555"],

Cell[CellGroupData[{

Cell["Reflection", "Section",
 CellChangeTimes->{{3.9447090526321225`*^9, 
  3.944709054036578*^9}},ExpressionUUID->"9316a4c4-277d-4b94-87fe-\
956f5ec68bb9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "g"}], "\[Antigeometric]", "p", "\[Antigeometric]", 
     RowBox[{"Antirev", "[", "g", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"gx", "^", "2"}], "+", 
       RowBox[{"gy", "^", "2"}], "+", 
       RowBox[{"gz", "^", "2"}]}], "==", "1"}], "}"}]}], "]"}], "//", 
  "BasisForm"}]], "Input",
 CellChangeTimes->{{3.9447090682899284`*^9, 3.944709072293764*^9}, {
  3.9448457300647464`*^9, 3.9448457380297556`*^9}, {3.9449618770224357`*^9, 
  3.944961885050955*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"8cd0280d-6ca5-45cf-bff6-96121b12b4c2"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    FormBox[
     TagBox[
      SubscriptBox[
       StyleBox["\<\"e\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->16,
        FontWeight->Bold], 
       StyleBox["\<\"1\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->9]],
      DisplayForm],
     TraditionalForm], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "gw", " ", "gx", " ", "pw"}], "+", 
      RowBox[{"2", " ", "gx", " ", "gy", " ", "py"}], "+", 
      RowBox[{"2", " ", "gx", " ", "gz", " ", "pz"}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["gy", "2"], " ", "px"}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["gz", "2"], " ", "px"}], "+", "px"}], ")"}]}], "+", 
   RowBox[{
    FormBox[
     TagBox[
      SubscriptBox[
       StyleBox["\<\"e\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->16,
        FontWeight->Bold], 
       StyleBox["\<\"2\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->9]],
      DisplayForm],
     TraditionalForm], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "gw", " ", "gy", " ", "pw"}], "+", 
      RowBox[{"2", " ", "gx", " ", "gy", " ", "px"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["gy", "2"], " ", "py"}], "+", 
      RowBox[{"2", " ", "gy", " ", "gz", " ", "pz"}], "-", "py"}], ")"}]}], 
   "+", 
   RowBox[{
    FormBox[
     TagBox[
      SubscriptBox[
       StyleBox["\<\"e\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->16,
        FontWeight->Bold], 
       StyleBox["\<\"3\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->9]],
      DisplayForm],
     TraditionalForm], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "gw", " ", "gz", " ", "pw"}], "+", 
      RowBox[{"2", " ", "gx", " ", "gz", " ", "px"}], "+", 
      RowBox[{"2", " ", "gy", " ", "gz", " ", "py"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["gz", "2"], " ", "pz"}], "-", "pz"}], ")"}]}], "-", 
   RowBox[{"pw", " ", 
    FormBox[
     TagBox[
      SubscriptBox[
       StyleBox["\<\"e\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->16,
        FontWeight->Bold], 
       StyleBox["\<\"4\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->9]],
      DisplayForm],
     TraditionalForm]}]}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.9447090692156115`*^9, 3.944709072807866*^9}, 
   3.944709615295161*^9, 3.944710822682352*^9, 3.944757577487853*^9, {
   3.94494881553008*^9, 3.9449488370810037`*^9}, 3.9449492357732596`*^9, 
   3.9449591255488358`*^9, 3.944961762687945*^9, 3.9449618861110306`*^9, 
   3.944964281347101*^9},
 CellLabel->
  "Out[5]//TraditionalForm=",ExpressionUUID->"359f7422-a408-40f0-bc2e-\
f788657fbbe0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"OperatorMatrix", "[", 
    RowBox[{"g", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"gx", "^", "2"}], "+", 
        RowBox[{"gy", "^", "2"}], "+", 
        RowBox[{"gz", "^", "2"}]}], "==", "1"}], "}"}]}], "]"}]}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.9447090938393393`*^9, 3.9447091035986824`*^9}, {
  3.944709171776346*^9, 3.9447091928184724`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"54e28eab-da8b-4da4-b5a3-8e713533587c"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"1", "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["gy", "2"]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["gz", "2"]}]}], 
      RowBox[{"2", " ", "gx", " ", "gy"}], 
      RowBox[{"2", " ", "gx", " ", "gz"}], 
      RowBox[{"2", " ", "gw", " ", "gx"}]},
     {
      RowBox[{"2", " ", "gx", " ", "gy"}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["gy", "2"]}]}], 
      RowBox[{"2", " ", "gy", " ", "gz"}], 
      RowBox[{"2", " ", "gw", " ", "gy"}]},
     {
      RowBox[{"2", " ", "gx", " ", "gz"}], 
      RowBox[{"2", " ", "gy", " ", "gz"}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["gz", "2"]}]}], 
      RowBox[{"2", " ", "gw", " ", "gz"}]},
     {"0", "0", "0", 
      RowBox[{"-", "1"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.9447091043705544`*^9, {3.9447091772778563`*^9, 3.9447091933660746`*^9}, 
   3.9447096153401604`*^9, 3.944710822725853*^9, 3.9447575775862174`*^9, {
   3.9449488155646095`*^9, 3.9449488371190314`*^9}, 3.9449492358112884`*^9, 
   3.944959125588439*^9, 3.944961762727463*^9, 3.944964281414586*^9},
 CellLabel->
  "Out[6]//MatrixForm=",ExpressionUUID->"1cc8694c-b02c-43da-a649-\
eb50411eaf98"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Translation", "Section",
 CellChangeTimes->{{3.9447080400710573`*^9, 
  3.944708041819662*^9}},ExpressionUUID->"9c5df87e-1386-435d-897d-\
bcbcec2863f8"],

Cell[BoxData[
 RowBox[{"translation", ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"tx", "/", "2"}], " ", 
    RowBox[{"e", "[", 
     RowBox[{"2", ",", "3"}], "]"}]}], "+", 
   RowBox[{
    RowBox[{"ty", "/", "2"}], " ", 
    RowBox[{"e", "[", 
     RowBox[{"3", ",", "1"}], "]"}]}], "+", 
   RowBox[{
    RowBox[{"tz", "/", "2"}], " ", 
    RowBox[{"e", "[", 
     RowBox[{"1", ",", "2"}], "]"}]}], "+", 
   RowBox[{"e", "[", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.944708047179418*^9, 3.9447080760377836`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"69e0fbcd-cd4f-44cf-bc55-052a48d3414d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"translation", "\[Antigeometric]", "p", "\[Antigeometric]", 
   RowBox[{"Antirev", "[", "translation", "]"}]}], "//", 
  "BasisForm"}]], "Input",
 CellChangeTimes->{{3.944708105597205*^9, 3.944708133553064*^9}, {
  3.9449618901533885`*^9, 3.94496190134265*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"f3c343b6-d06e-4bbe-9288-ff7e589438dc"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    FormBox[
     TagBox[
      SubscriptBox[
       StyleBox["\<\"e\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->16,
        FontWeight->Bold], 
       StyleBox["\<\"1\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->9]],
      DisplayForm],
     TraditionalForm], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"pw", " ", "tx"}], "+", "px"}], ")"}]}], "+", 
   RowBox[{
    FormBox[
     TagBox[
      SubscriptBox[
       StyleBox["\<\"e\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->16,
        FontWeight->Bold], 
       StyleBox["\<\"2\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->9]],
      DisplayForm],
     TraditionalForm], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"pw", " ", "ty"}], "+", "py"}], ")"}]}], "+", 
   RowBox[{
    FormBox[
     TagBox[
      SubscriptBox[
       StyleBox["\<\"e\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->16,
        FontWeight->Bold], 
       StyleBox["\<\"3\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->9]],
      DisplayForm],
     TraditionalForm], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"pw", " ", "tz"}], "+", "pz"}], ")"}]}], "+", 
   RowBox[{"pw", " ", 
    FormBox[
     TagBox[
      SubscriptBox[
       StyleBox["\<\"e\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->16,
        FontWeight->Bold], 
       StyleBox["\<\"4\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->9]],
      DisplayForm],
     TraditionalForm]}]}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.944708123714389*^9, 3.944708134022957*^9}, 
   3.9447086353915634`*^9, 3.9447096154586606`*^9, 3.9447108227483516`*^9, 
   3.944757577608609*^9, {3.9449488155836253`*^9, 3.9449488371415443`*^9}, 
   3.9449492358336*^9, 3.9449591256089506`*^9, 3.9449617627454753`*^9, 
   3.9449619021213455`*^9, 3.944964281437127*^9},
 CellLabel->
  "Out[8]//TraditionalForm=",ExpressionUUID->"168453b3-a1df-4e21-afec-\
7b69be053aaa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"OperatorMatrix", "[", "translation", "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.9447080846163607`*^9, 3.9447080905318675`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"edec815e-81f3-41ac-ae96-3dc561e1fd0d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "tx"},
     {"0", "1", "0", "ty"},
     {"0", "0", "1", "tz"},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.9447080914955244`*^9, 3.9447086354020643`*^9, 3.944709615470661*^9, 
   3.944710822764852*^9, 3.9447575776281805`*^9, {3.9449488155956306`*^9, 
   3.9449488371535506`*^9}, 3.9449492358461065`*^9, 3.9449591256189585`*^9, 
   3.9449617627569795`*^9, 3.944964281452587*^9},
 CellLabel->
  "Out[9]//MatrixForm=",ExpressionUUID->"e9910faa-d698-4e64-bb1e-\
c76f71cc231d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Quaternion Rotation", "Section",
 CellChangeTimes->{{3.9449599251986876`*^9, 3.9449599264454784`*^9}, {
  3.9449604913831606`*^9, 
  3.9449604926825743`*^9}},ExpressionUUID->"28e60a0a-e3d7-47f7-99cc-\
6e54cb5c84ad"],

Cell[BoxData[
 RowBox[{"quaternion", ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"vx", " ", 
       RowBox[{"e", "[", 
        RowBox[{"4", ",", "1"}], "]"}]}], "+", 
      RowBox[{"vy", " ", 
       RowBox[{"e", "[", 
        RowBox[{"4", ",", "2"}], "]"}]}], "+", 
      RowBox[{"vz", " ", 
       RowBox[{"e", "[", 
        RowBox[{"4", ",", "3"}], "]"}]}]}], ")"}], 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Phi]", "/", "2"}], "]"}]}], "+", 
   RowBox[{
    RowBox[{"e", "[", 
     RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "]"}], 
    RowBox[{"Cos", "[", 
     RowBox[{"\[Phi]", "/", "2"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9449599281913333`*^9, 3.9449599808981323`*^9}, {
  3.944961928285902*^9, 3.944961933555709*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"1967ce37-8d99-44bb-915a-77a8ed12e167"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"quaternion", "\[Antigeometric]", "p", "\[Antigeometric]", 
     RowBox[{"Rev", "[", "quaternion", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"vx", "^", "2"}], "+", 
       RowBox[{"vy", "^", "2"}], "+", 
       RowBox[{"vz", "^", "2"}]}], "==", "1"}], "}"}]}], "]"}], "//", 
  "BasisForm"}]], "Input",
 CellChangeTimes->{{3.944960196325054*^9, 3.9449602198192663`*^9}, {
  3.9449602537662992`*^9, 3.9449602556823435`*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"8c2ec614-5e83-4705-b36b-0f6a75495708"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    FormBox[
     TagBox[
      SubscriptBox[
       StyleBox["\<\"e\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->16,
        FontWeight->Bold], 
       StyleBox["\<\"1\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->9]],
      DisplayForm],
     TraditionalForm], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"px", " ", 
       SuperscriptBox["vy", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"cos", "(", "\[Phi]", ")"}], "-", "1"}], ")"}]}], "+", 
      RowBox[{"px", " ", 
       SuperscriptBox["vz", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"cos", "(", "\[Phi]", ")"}], "-", "1"}], ")"}]}], "+", "px", 
      "-", 
      RowBox[{"py", " ", "vx", " ", "vy", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"cos", "(", "\[Phi]", ")"}], "-", "1"}], ")"}]}], "-", 
      RowBox[{"py", " ", "vz", " ", 
       RowBox[{"sin", "(", "\[Phi]", ")"}]}], "-", 
      RowBox[{"pz", " ", "vx", " ", "vz", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"cos", "(", "\[Phi]", ")"}], "-", "1"}], ")"}]}], "+", 
      RowBox[{"pz", " ", "vy", " ", 
       RowBox[{"sin", "(", "\[Phi]", ")"}]}]}], ")"}]}], "+", 
   RowBox[{
    FormBox[
     TagBox[
      SubscriptBox[
       StyleBox["\<\"e\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->16,
        FontWeight->Bold], 
       StyleBox["\<\"2\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->9]],
      DisplayForm],
     TraditionalForm], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"px", " ", "vx", " ", "vy", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"cos", "(", "\[Phi]", ")"}], "-", "1"}], ")"}]}]}], "+", 
      RowBox[{"px", " ", "vz", " ", 
       RowBox[{"sin", "(", "\[Phi]", ")"}]}], "-", 
      RowBox[{"py", " ", 
       SuperscriptBox["vy", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"cos", "(", "\[Phi]", ")"}], "-", "1"}], ")"}]}], "+", 
      RowBox[{"py", " ", 
       RowBox[{"cos", "(", "\[Phi]", ")"}]}], "-", 
      RowBox[{"pz", " ", "vx", " ", 
       RowBox[{"sin", "(", "\[Phi]", ")"}]}], "-", 
      RowBox[{"pz", " ", "vy", " ", "vz", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"cos", "(", "\[Phi]", ")"}], "-", "1"}], ")"}]}]}], ")"}]}], 
   "+", 
   RowBox[{
    FormBox[
     TagBox[
      SubscriptBox[
       StyleBox["\<\"e\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->16,
        FontWeight->Bold], 
       StyleBox["\<\"3\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->9]],
      DisplayForm],
     TraditionalForm], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"px", " ", "vx", " ", "vz", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"cos", "(", "\[Phi]", ")"}], "-", "1"}], ")"}]}]}], "-", 
      RowBox[{"px", " ", "vy", " ", 
       RowBox[{"sin", "(", "\[Phi]", ")"}]}], "+", 
      RowBox[{"py", " ", "vx", " ", 
       RowBox[{"sin", "(", "\[Phi]", ")"}]}], "-", 
      RowBox[{"py", " ", "vy", " ", "vz", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"cos", "(", "\[Phi]", ")"}], "-", "1"}], ")"}]}], "-", 
      RowBox[{"pz", " ", 
       SuperscriptBox["vz", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"cos", "(", "\[Phi]", ")"}], "-", "1"}], ")"}]}], "+", 
      RowBox[{"pz", " ", 
       RowBox[{"cos", "(", "\[Phi]", ")"}]}]}], ")"}]}], "+", 
   RowBox[{"pw", " ", 
    FormBox[
     TagBox[
      SubscriptBox[
       StyleBox["\<\"e\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->16,
        FontWeight->Bold], 
       StyleBox["\<\"4\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->9]],
      DisplayForm],
     TraditionalForm]}]}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.944960206140253*^9, 3.944960220637477*^9}, 
   3.9449602561974792`*^9, 3.9449613966716967`*^9, 3.9449619372342243`*^9, 
   3.9449642819156075`*^9},
 CellLabel->
  "Out[11]//TraditionalForm=",ExpressionUUID->"a74bd3a6-df1e-4048-b480-\
de0aa0527095"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{"OperatorMatrix", "[", 
    RowBox[{"quaternion", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"vx", "^", "2"}], "+", 
        RowBox[{"vy", "^", "2"}], "+", 
        RowBox[{"vz", "^", "2"}]}], "==", "1"}], "}"}]}], "]"}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.9449602580812736`*^9, 3.9449602954227*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"4c09bb8c-f92c-479c-887d-fba492a1f77e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"1", "-", 
       SuperscriptBox["vy", "2"], "-", 
       SuperscriptBox["vz", "2"], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["vy", "2"], "+", 
          SuperscriptBox["vz", "2"]}], ")"}], " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], 
      RowBox[{
       RowBox[{"vx", " ", "vy"}], "-", 
       RowBox[{"vx", " ", "vy", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "-", 
       RowBox[{"vz", " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], 
      RowBox[{
       RowBox[{"vx", " ", "vz"}], "-", 
       RowBox[{"vx", " ", "vz", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
       RowBox[{"vy", " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], "0"},
     {
      RowBox[{
       RowBox[{"vx", " ", "vy"}], "-", 
       RowBox[{"vx", " ", "vy", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
       RowBox[{"vz", " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], 
      RowBox[{
       SuperscriptBox["vy", "2"], "+", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}], "-", 
       RowBox[{
        SuperscriptBox["vy", "2"], " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], 
      RowBox[{
       RowBox[{"vy", " ", "vz"}], "-", 
       RowBox[{"vy", " ", "vz", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "-", 
       RowBox[{"vx", " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], "0"},
     {
      RowBox[{
       RowBox[{"vx", " ", "vz"}], "-", 
       RowBox[{"vx", " ", "vz", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "-", 
       RowBox[{"vy", " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], 
      RowBox[{
       RowBox[{"vy", " ", "vz"}], "-", 
       RowBox[{"vy", " ", "vz", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
       RowBox[{"vx", " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], 
      RowBox[{
       SuperscriptBox["vz", "2"], "+", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}], "-", 
       RowBox[{
        SuperscriptBox["vz", "2"], " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], "0"},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.9449602749837017`*^9, 3.9449602961998835`*^9}, 
   3.9449613969639883`*^9, 3.9449619409319625`*^9, 3.9449642823729916`*^9},
 CellLabel->
  "Out[12]//MatrixForm=",ExpressionUUID->"519be854-3480-4f3f-ba50-\
02224f835008"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RightComp", "[", "quaternion", "]"}], "//", "BasisForm"}]], "Input",
 CellChangeTimes->{{3.9449603652199883`*^9, 3.9449603779640656`*^9}, {
  3.944961950283454*^9, 3.9449619514267497`*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"8b680d1b-5638-42f3-81df-9fcc38a0b79a"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    FormBox[
     TagBox[
      StyleBox["\<\"1\"\>",
       StripOnInput->False,
       FontFamily->"Times New Roman",
       FontSize->16,
       FontWeight->Bold],
      DisplayForm],
     TraditionalForm], " ", 
    RowBox[{"cos", "(", 
     FractionBox["\[Phi]", "2"], ")"}]}], "-", 
   RowBox[{"vz", " ", 
    RowBox[{"sin", "(", 
     FractionBox["\[Phi]", "2"], ")"}], " ", 
    FormBox[
     TagBox[
      SubscriptBox[
       StyleBox["\<\"e\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->16,
        FontWeight->Bold], 
       StyleBox["\<\"12\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->9]],
      DisplayForm],
     TraditionalForm]}], "-", 
   RowBox[{"vx", " ", 
    RowBox[{"sin", "(", 
     FractionBox["\[Phi]", "2"], ")"}], " ", 
    FormBox[
     TagBox[
      SubscriptBox[
       StyleBox["\<\"e\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->16,
        FontWeight->Bold], 
       StyleBox["\<\"23\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->9]],
      DisplayForm],
     TraditionalForm]}], "-", 
   RowBox[{"vy", " ", 
    RowBox[{"sin", "(", 
     FractionBox["\[Phi]", "2"], ")"}], " ", 
    FormBox[
     TagBox[
      SubscriptBox[
       StyleBox["\<\"e\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->16,
        FontWeight->Bold], 
       StyleBox["\<\"31\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->9]],
      DisplayForm],
     TraditionalForm]}]}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.9449603711711764`*^9, 3.9449603784262652`*^9}, 
   3.944961397020791*^9, 3.944961952055828*^9, 3.9449642824503517`*^9},
 CellLabel->
  "Out[13]//TraditionalForm=",ExpressionUUID->"c3f25e0b-3031-4803-8c4e-\
76cbac38c924"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"RightComp", "[", "quaternion", "]"}], "\[Geometric]", "p", 
     "\[Geometric]", 
     RowBox[{"Rev", "[", 
      RowBox[{"RightComp", "[", "quaternion", "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"vx", "^", "2"}], "+", 
       RowBox[{"vy", "^", "2"}], "+", 
       RowBox[{"vz", "^", "2"}]}], "==", "1"}], "}"}]}], "]"}], "//", 
  "BasisForm"}]], "Input",
 CellChangeTimes->{{3.944960422682106*^9, 3.944960429094967*^9}, {
  3.944961957714454*^9, 3.9449619600975237`*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"8bb837b3-aa6e-474c-81d9-9a92c23c6a44"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    FormBox[
     TagBox[
      SubscriptBox[
       StyleBox["\<\"e\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->16,
        FontWeight->Bold], 
       StyleBox["\<\"1\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->9]],
      DisplayForm],
     TraditionalForm], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"px", " ", 
       SuperscriptBox["vy", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"cos", "(", "\[Phi]", ")"}], "-", "1"}], ")"}]}], "+", 
      RowBox[{"px", " ", 
       SuperscriptBox["vz", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"cos", "(", "\[Phi]", ")"}], "-", "1"}], ")"}]}], "+", "px", 
      "-", 
      RowBox[{"py", " ", "vx", " ", "vy", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"cos", "(", "\[Phi]", ")"}], "-", "1"}], ")"}]}], "-", 
      RowBox[{"py", " ", "vz", " ", 
       RowBox[{"sin", "(", "\[Phi]", ")"}]}], "-", 
      RowBox[{"pz", " ", "vx", " ", "vz", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"cos", "(", "\[Phi]", ")"}], "-", "1"}], ")"}]}], "+", 
      RowBox[{"pz", " ", "vy", " ", 
       RowBox[{"sin", "(", "\[Phi]", ")"}]}]}], ")"}]}], "+", 
   RowBox[{
    FormBox[
     TagBox[
      SubscriptBox[
       StyleBox["\<\"e\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->16,
        FontWeight->Bold], 
       StyleBox["\<\"2\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->9]],
      DisplayForm],
     TraditionalForm], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"px", " ", "vx", " ", "vy", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"cos", "(", "\[Phi]", ")"}], "-", "1"}], ")"}]}]}], "+", 
      RowBox[{"px", " ", "vz", " ", 
       RowBox[{"sin", "(", "\[Phi]", ")"}]}], "-", 
      RowBox[{"py", " ", 
       SuperscriptBox["vy", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"cos", "(", "\[Phi]", ")"}], "-", "1"}], ")"}]}], "+", 
      RowBox[{"py", " ", 
       RowBox[{"cos", "(", "\[Phi]", ")"}]}], "-", 
      RowBox[{"pz", " ", "vx", " ", 
       RowBox[{"sin", "(", "\[Phi]", ")"}]}], "-", 
      RowBox[{"pz", " ", "vy", " ", "vz", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"cos", "(", "\[Phi]", ")"}], "-", "1"}], ")"}]}]}], ")"}]}], 
   "+", 
   RowBox[{
    FormBox[
     TagBox[
      SubscriptBox[
       StyleBox["\<\"e\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->16,
        FontWeight->Bold], 
       StyleBox["\<\"3\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->9]],
      DisplayForm],
     TraditionalForm], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"px", " ", "vx", " ", "vz", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"cos", "(", "\[Phi]", ")"}], "-", "1"}], ")"}]}]}], "-", 
      RowBox[{"px", " ", "vy", " ", 
       RowBox[{"sin", "(", "\[Phi]", ")"}]}], "+", 
      RowBox[{"py", " ", "vx", " ", 
       RowBox[{"sin", "(", "\[Phi]", ")"}]}], "-", 
      RowBox[{"py", " ", "vy", " ", "vz", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"cos", "(", "\[Phi]", ")"}], "-", "1"}], ")"}]}], "-", 
      RowBox[{"pz", " ", 
       SuperscriptBox["vz", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"cos", "(", "\[Phi]", ")"}], "-", "1"}], ")"}]}], "+", 
      RowBox[{"pz", " ", 
       RowBox[{"cos", "(", "\[Phi]", ")"}]}]}], ")"}]}], "+", 
   RowBox[{"pw", " ", 
    FormBox[
     TagBox[
      SubscriptBox[
       StyleBox["\<\"e\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->16,
        FontWeight->Bold], 
       StyleBox["\<\"4\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->9]],
      DisplayForm],
     TraditionalForm]}]}], TraditionalForm]], "Output",
 CellChangeTimes->{3.9449604297807627`*^9, 3.9449613971113443`*^9, 
  3.9449619628237453`*^9, 3.9449642824888525`*^9},
 CellLabel->
  "Out[14]//TraditionalForm=",ExpressionUUID->"1728000d-52fc-4d05-a964-\
e7cb4fc3019a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Line Rotation", "Section",
 CellChangeTimes->{{3.944960498533409*^9, 
  3.944960500362156*^9}},ExpressionUUID->"9da1e3b4-bfc1-4e9d-829e-\
43a56bfb181f"],

Cell[BoxData[
 RowBox[{"R", ":=", 
  RowBox[{
   RowBox[{"l", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Phi]", "/", "2"}], "]"}]}], "+", 
   RowBox[{
    RowBox[{"e", "[", 
     RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "]"}], 
    RowBox[{"Cos", "[", 
     RowBox[{"\[Phi]", "/", "2"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.944960506984951*^9, 3.944960523246522*^9}, {
  3.94496196745275*^9, 3.9449619675525646`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"a812cd39-73e7-4ec4-bd9d-dbf7be5e9904"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"R", "\[Antigeometric]", "p", "\[Antigeometric]", 
     RowBox[{"Rev", "[", "R", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"lvx", "^", "2"}], "+", 
       RowBox[{"lvy", "^", "2"}], "+", 
       RowBox[{"lvz", "^", "2"}]}], "==", "1"}], "}"}]}], "]"}], "//", 
  "BasisForm"}]], "Input",
 CellChangeTimes->{{3.944960530714808*^9, 3.944960535547527*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"922b7654-0379-43f9-9676-992c60a9e460"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    FormBox[
     TagBox[
      SubscriptBox[
       StyleBox["\<\"e\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->16,
        FontWeight->Bold], 
       StyleBox["\<\"1\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->9]],
      DisplayForm],
     TraditionalForm], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"lmx", " ", "pw", " ", 
       RowBox[{"sin", "(", "\[Phi]", ")"}]}], "+", 
      RowBox[{"lmy", " ", "lvz", " ", "pw", " ", 
       RowBox[{"cos", "(", "\[Phi]", ")"}]}], "-", 
      RowBox[{"lmy", " ", "lvz", " ", "pw"}], "-", 
      RowBox[{"lmz", " ", "lvy", " ", "pw", " ", 
       RowBox[{"cos", "(", "\[Phi]", ")"}]}], "+", 
      RowBox[{"lmz", " ", "lvy", " ", "pw"}], "-", 
      RowBox[{"lvx", " ", "lvy", " ", "py", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"cos", "(", "\[Phi]", ")"}], "-", "1"}], ")"}]}], "-", 
      RowBox[{"lvx", " ", "lvz", " ", "pz", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"cos", "(", "\[Phi]", ")"}], "-", "1"}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["lvy", "2"], " ", "px", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"cos", "(", "\[Phi]", ")"}], "-", "1"}], ")"}]}], "+", 
      RowBox[{"lvy", " ", "pz", " ", 
       RowBox[{"sin", "(", "\[Phi]", ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["lvz", "2"], " ", "px", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"cos", "(", "\[Phi]", ")"}], "-", "1"}], ")"}]}], "-", 
      RowBox[{"lvz", " ", "py", " ", 
       RowBox[{"sin", "(", "\[Phi]", ")"}]}], "+", "px"}], ")"}]}], "+", 
   RowBox[{
    FormBox[
     TagBox[
      SubscriptBox[
       StyleBox["\<\"e\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->16,
        FontWeight->Bold], 
       StyleBox["\<\"2\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->9]],
      DisplayForm],
     TraditionalForm], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"lmx", " ", "lvz", " ", "pw", " ", 
        RowBox[{"cos", "(", "\[Phi]", ")"}]}]}], "+", 
      RowBox[{"lmx", " ", "lvz", " ", "pw"}], "+", 
      RowBox[{"lmy", " ", "pw", " ", 
       RowBox[{"sin", "(", "\[Phi]", ")"}]}], "+", 
      RowBox[{"lmz", " ", "lvx", " ", "pw", " ", 
       RowBox[{"cos", "(", "\[Phi]", ")"}]}], "-", 
      RowBox[{"lmz", " ", "lvx", " ", "pw"}], "-", 
      RowBox[{"lvx", " ", "lvy", " ", "px", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"cos", "(", "\[Phi]", ")"}], "-", "1"}], ")"}]}], "-", 
      RowBox[{"lvx", " ", "pz", " ", 
       RowBox[{"sin", "(", "\[Phi]", ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["lvy", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"-", "py"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"cos", "(", "\[Phi]", ")"}], "-", "1"}], ")"}]}], "-", 
      RowBox[{"lvy", " ", "lvz", " ", "pz", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"cos", "(", "\[Phi]", ")"}], "-", "1"}], ")"}]}], "+", 
      RowBox[{"lvz", " ", "px", " ", 
       RowBox[{"sin", "(", "\[Phi]", ")"}]}], "+", 
      RowBox[{"py", " ", 
       RowBox[{"cos", "(", "\[Phi]", ")"}]}]}], ")"}]}], "+", 
   RowBox[{
    FormBox[
     TagBox[
      SubscriptBox[
       StyleBox["\<\"e\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->16,
        FontWeight->Bold], 
       StyleBox["\<\"3\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->9]],
      DisplayForm],
     TraditionalForm], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"lmx", " ", "lvy", " ", "pw", " ", 
       RowBox[{"cos", "(", "\[Phi]", ")"}]}], "-", 
      RowBox[{"lmx", " ", "lvy", " ", "pw"}], "-", 
      RowBox[{"lmy", " ", "lvx", " ", "pw", " ", 
       RowBox[{"cos", "(", "\[Phi]", ")"}]}], "+", 
      RowBox[{"lmy", " ", "lvx", " ", "pw"}], "+", 
      RowBox[{"lmz", " ", "pw", " ", 
       RowBox[{"sin", "(", "\[Phi]", ")"}]}], "-", 
      RowBox[{"lvx", " ", "lvz", " ", "px", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"cos", "(", "\[Phi]", ")"}], "-", "1"}], ")"}]}], "+", 
      RowBox[{"lvx", " ", "py", " ", 
       RowBox[{"sin", "(", "\[Phi]", ")"}]}], "-", 
      RowBox[{"lvy", " ", "lvz", " ", "py", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"cos", "(", "\[Phi]", ")"}], "-", "1"}], ")"}]}], "-", 
      RowBox[{"lvy", " ", "px", " ", 
       RowBox[{"sin", "(", "\[Phi]", ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["lvz", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"-", "pz"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"cos", "(", "\[Phi]", ")"}], "-", "1"}], ")"}]}], "+", 
      RowBox[{"pz", " ", 
       RowBox[{"cos", "(", "\[Phi]", ")"}]}]}], ")"}]}], "+", 
   RowBox[{"pw", " ", 
    FormBox[
     TagBox[
      SubscriptBox[
       StyleBox["\<\"e\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->16,
        FontWeight->Bold], 
       StyleBox["\<\"4\"\>",
        StripOnInput->False,
        FontFamily->"Times New Roman",
        FontSize->9]],
      DisplayForm],
     TraditionalForm]}]}], TraditionalForm]], "Output",
 CellChangeTimes->{3.944960537394286*^9, 3.9449613980868435`*^9, 
  3.9449619709918427`*^9, 3.944964283673644*^9},
 CellLabel->
  "Out[16]//TraditionalForm=",ExpressionUUID->"791c04f8-89d1-4065-80f2-\
dd6c3b90d33e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"OperatorMatrix", "[", 
   RowBox[{"R", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"lvx", "^", "2"}], "+", 
       RowBox[{"lvy", "^", "2"}], "+", 
       RowBox[{"lvz", "^", "2"}]}], "==", "1"}], "}"}]}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.944960577820657*^9, 3.9449605937491226`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"5220f160-6e31-404b-b534-204e6d1ba96e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"1", "-", 
       SuperscriptBox["lvy", "2"], "-", 
       SuperscriptBox["lvz", "2"], "+", 
       RowBox[{
        SuperscriptBox["lvy", "2"], " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["lvz", "2"], " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], 
      RowBox[{
       RowBox[{"lvx", " ", "lvy"}], "-", 
       RowBox[{"lvx", " ", "lvy", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "-", 
       RowBox[{"lvz", " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], 
      RowBox[{
       RowBox[{"lvx", " ", "lvz"}], "-", 
       RowBox[{"lvx", " ", "lvz", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
       RowBox[{"lvy", " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], 
      RowBox[{
       RowBox[{"lmz", " ", "lvy"}], "-", 
       RowBox[{"lmy", " ", "lvz"}], "-", 
       RowBox[{"lmz", " ", "lvy", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
       RowBox[{"lmy", " ", "lvz", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
       RowBox[{"lmx", " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}]},
     {
      RowBox[{
       RowBox[{"lvx", " ", "lvy"}], "-", 
       RowBox[{"lvx", " ", "lvy", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
       RowBox[{"lvz", " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], 
      RowBox[{
       SuperscriptBox["lvy", "2"], "+", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}], "-", 
       RowBox[{
        SuperscriptBox["lvy", "2"], " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], 
      RowBox[{
       RowBox[{"lvy", " ", "lvz"}], "-", 
       RowBox[{"lvy", " ", "lvz", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "-", 
       RowBox[{"lvx", " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "lmz"}], " ", "lvx"}], "+", 
       RowBox[{"lmx", " ", "lvz"}], "+", 
       RowBox[{"lmz", " ", "lvx", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "-", 
       RowBox[{"lmx", " ", "lvz", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
       RowBox[{"lmy", " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}]},
     {
      RowBox[{
       RowBox[{"lvx", " ", "lvz"}], "-", 
       RowBox[{"lvx", " ", "lvz", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "-", 
       RowBox[{"lvy", " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], 
      RowBox[{
       RowBox[{"lvy", " ", "lvz"}], "-", 
       RowBox[{"lvy", " ", "lvz", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
       RowBox[{"lvx", " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], 
      RowBox[{
       SuperscriptBox["lvz", "2"], "+", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}], "-", 
       RowBox[{
        SuperscriptBox["lvz", "2"], " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], 
      RowBox[{
       RowBox[{"lmy", " ", "lvx"}], "-", 
       RowBox[{"lmx", " ", "lvy"}], "-", 
       RowBox[{"lmy", " ", "lvx", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
       RowBox[{"lmx", " ", "lvy", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
       RowBox[{"lmz", " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}]},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.9449605898890853`*^9, 3.944960595788192*^9}, 
   3.9449613990829625`*^9, 3.944961982150464*^9, 3.9449642855532446`*^9},
 CellLabel->
  "Out[17]//MatrixForm=",ExpressionUUID->"1322624c-7a4c-4def-bc24-\
750a43fa43f1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["General Screw", "Section",
 CellChangeTimes->{{3.9449642866699467`*^9, 
  3.9449642886957293`*^9}},ExpressionUUID->"dc20984d-eb36-4c0e-9ac4-\
6aab2cec8c88"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Q", "[", 
   RowBox[{"l_", ",", "\[Phi]_", ",", "\[Delta]_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"l", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Phi]", "/", "2"}], "]"}]}], "+", 
   RowBox[{
    RowBox[{"e", "[", 
     RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "]"}], 
    RowBox[{"Cos", "[", 
     RowBox[{"\[Phi]", "/", "2"}], "]"}]}], "-", 
   RowBox[{
    RowBox[{"WeightDual", "[", "l", "]"}], 
    RowBox[{"\[Delta]", "/", "2"}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"\[Phi]", "/", "2"}], "]"}]}], "-", 
   RowBox[{
    RowBox[{"\[Delta]", "/", "2"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Phi]", "/", "2"}], "]"}], 
    RowBox[{"e", "[", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9449642918079176`*^9, 3.9449643071091475`*^9}, {
  3.944964338108818*^9, 3.9449644021661663`*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"ae6ded29-cea2-4891-b07a-af09c6f22621"]
}, Open  ]]
},
WindowSize->{1508, 970},
WindowMargins->{{Automatic, 164}, {15, Automatic}},
Magnification:>1. Inherited,
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"6f8d2bb3-dffd-47c2-9108-1016619334ad"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 455, 8, 28, "Input",ExpressionUUID->"a7d79b4c-8ac3-49dc-931a-f2ce114ed620"],
Cell[1016, 30, 560, 14, 28, "Input",ExpressionUUID->"ce094da8-af9b-46d9-bb0e-4143fb79b96b"],
Cell[1579, 46, 855, 24, 28, "Input",ExpressionUUID->"a278789b-934c-478c-af32-5bf0b9fd5b65"],
Cell[2437, 72, 733, 18, 28, "Input",ExpressionUUID->"d20f23ba-1d22-423a-b83c-b2a22e916555"],
Cell[CellGroupData[{
Cell[3195, 94, 157, 3, 67, "Section",ExpressionUUID->"9316a4c4-277d-4b94-87fe-956f5ec68bb9"],
Cell[CellGroupData[{
Cell[3377, 101, 669, 17, 28, "Input",ExpressionUUID->"8cd0280d-6ca5-45cf-bff6-96121b12b4c2"],
Cell[4049, 120, 2999, 94, 47, "Output",ExpressionUUID->"359f7422-a408-40f0-bc2e-f788657fbbe0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7085, 219, 528, 14, 28, "Input",ExpressionUUID->"54e28eab-da8b-4da4-b5a3-8e713533587c"],
Cell[7616, 235, 1716, 48, 103, "Output",ExpressionUUID->"1cc8694c-b02c-43da-a649-eb50411eaf98"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[9381, 289, 158, 3, 67, "Section",ExpressionUUID->"9c5df87e-1386-435d-897d-bcbcec2863f8"],
Cell[9542, 294, 641, 18, 28, "Input",ExpressionUUID->"69e0fbcd-cd4f-44cf-bc55-052a48d3414d"],
Cell[CellGroupData[{
Cell[10208, 316, 373, 7, 28, "Input",ExpressionUUID->"f3c343b6-d06e-4bbe-9288-ff7e589438dc"],
Cell[10584, 325, 2287, 79, 44, "Output",ExpressionUUID->"168453b3-a1df-4e21-afec-7b69be053aaa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12908, 409, 261, 5, 28, "Input",ExpressionUUID->"edec815e-81f3-41ac-ae96-3dc561e1fd0d"],
Cell[13172, 416, 949, 25, 94, "Output",ExpressionUUID->"e9910faa-d698-4e64-bb1e-c76f71cc231d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[14170, 447, 221, 4, 67, "Section",ExpressionUUID->"28e60a0a-e3d7-47f7-99cc-6e54cb5c84ad"],
Cell[14394, 453, 851, 24, 28, "Input",ExpressionUUID->"1967ce37-8d99-44bb-915a-77a8ed12e167"],
Cell[CellGroupData[{
Cell[15270, 481, 612, 15, 28, "Input",ExpressionUUID->"8c2ec614-5e83-4705-b36b-0f6a75495708"],
Cell[15885, 498, 4394, 138, 68, "Output",ExpressionUUID->"a74bd3a6-df1e-4048-b480-de0aa0527095"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20316, 641, 500, 13, 28, "Input",ExpressionUUID->"4c09bb8c-f92c-479c-887d-fba492a1f77e"],
Cell[20819, 656, 2821, 79, 105, "Output",ExpressionUUID->"519be854-3480-4f3f-ba50-02224f835008"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23677, 740, 303, 5, 28, "Input",ExpressionUUID->"8b680d1b-5638-42f3-81df-9fcc38a0b79a"],
Cell[23983, 747, 1980, 70, 59, "Output",ExpressionUUID->"c3f25e0b-3031-4803-8c4e-76cbac38c924"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26000, 822, 685, 18, 28, "Input",ExpressionUUID->"8bb837b3-aa6e-474c-81d9-9a92c23c6a44"],
Cell[26688, 842, 4343, 137, 68, "Output",ExpressionUUID->"1728000d-52fc-4d05-a964-e7cb4fc3019a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[31080, 985, 158, 3, 67, "Section",ExpressionUUID->"9da1e3b4-bfc1-4e9d-829e-43a56bfb181f"],
Cell[31241, 990, 513, 13, 28, "Input",ExpressionUUID->"a812cd39-73e7-4ec4-bd9d-dbf7be5e9904"],
Cell[CellGroupData[{
Cell[31779, 1007, 542, 14, 28, "Input",ExpressionUUID->"922b7654-0379-43f9-9676-992c60a9e460"],
Cell[32324, 1023, 5620, 162, 89, "Output",ExpressionUUID->"791c04f8-89d1-4065-80f2-dd6c3b90d33e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37981, 1190, 453, 12, 28, "Input",ExpressionUUID->"5220f160-6e31-404b-b534-204e6d1ba96e"],
Cell[38437, 1204, 3969, 107, 103, "Output",ExpressionUUID->"1322624c-7a4c-4def-bc24-750a43fa43f1"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[42455, 1317, 162, 3, 67, "Section",ExpressionUUID->"dc20984d-eb36-4c0e-9ac4-6aab2cec8c88"],
Cell[42620, 1322, 927, 25, 28, "Input",ExpressionUUID->"ae6ded29-cea2-4891-b07a-af09c6f22621"]
}, Open  ]]
}
]
*)

